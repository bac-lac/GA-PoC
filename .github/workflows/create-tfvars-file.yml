name: Reusable workflow example

on:
  workflow_call:
    inputs:
      environment:
        required: true
        type: string
      ecr_image:
        required: true
        type: string

jobs:
  triage:
    runs-on: ubuntu-latest
    environment: ${{ inputs.environment }}
    steps:
      - name: Setup Terraform variables
        id: vars
        run: |-
          cat > pipeline.auto.tfvars <<EOF
          BRANCH_NAME = "${{ github.head_ref || github.ref_name }}"
          ECR_IMAGE = "${{ inputs.ecr_image }}"
          ENV = "${{ vars.ENV }}"
          DB_USERNAME = "${{ secrets.DB_USERNAME }}"
          FORCE_REFRESH = "${{ vars.FORCE_REFRESH }}"
          MFT_CLUSTER = "${{ vars.MFT_CLUSTER }}"
          EOF
      - name: Print Terraform variables
        id: print
        run: cat pipeline.auto.tfvars